# Phishing Brand Classifier Configuration

# Data settings
data:
  raw_dir: "data/raw"
  processed_dir: "data/processed"
  image_size: 224
  train_split: 0.7
  val_split: 0.15
  test_split: 0.15
  random_seed: 42

  # Brand classes (10 brands + others)
  classes:
    - amazon
    - apple
    - facebook
    - google
    - linkedin
    - microsoft
    - netflix
    - paypal
    - instagram
    - twitter
    - others  # Benign websites

# Model settings
model:
  # Architecture options: resnet50, efficientnet_b0, efficientnet_b3, vit_base
  architecture: "efficientnet_b0"
  pretrained: true
  num_classes: 11
  dropout: 0.3

  # For handling class imbalance with "others"
  use_class_weights: true

  # Confidence threshold for classification
  # Higher threshold = fewer false positives (benign classified as brand)
  confidence_threshold: 0.85

  # Enable focal loss for handling class imbalance
  use_focal_loss: true
  focal_loss_gamma: 2.0
  focal_loss_alpha: null  # Will be set based on class weights

# Training settings
training:
  batch_size: 32
  num_epochs: 50
  learning_rate: 0.001
  weight_decay: 0.0001

  # Learning rate scheduler
  scheduler: "cosine"  # Options: step, cosine, plateau
  scheduler_step_size: 10
  scheduler_gamma: 0.1

  # Early stopping
  early_stopping_patience: 10
  early_stopping_min_delta: 0.001

  # Mixed precision training
  use_amp: true

  # Gradient accumulation for effective larger batch size
  gradient_accumulation_steps: 1

  # Number of workers for data loading
  num_workers: 4

  # Checkpointing
  save_best_only: true
  checkpoint_dir: "outputs/models"

# Augmentation settings
augmentation:
  # Training augmentations
  train:
    horizontal_flip: true
    vertical_flip: false
    rotation_limit: 15
    brightness_limit: 0.2
    contrast_limit: 0.2
    blur_limit: 3
    noise_limit: 0.05

  # Test-time augmentation
  tta:
    enabled: false
    num_augments: 5

# Evaluation settings
evaluation:
  # Metrics to compute
  metrics:
    - accuracy
    - precision
    - recall
    - f1_score
    - confusion_matrix
    - per_class_metrics

  # Special focus on false positive rate for "others" class
  # This is critical: benign sites should NOT be classified as brands
  false_positive_analysis: true

  # Threshold optimization for minimizing false positives
  optimize_threshold: true
  threshold_metric: "f1_weighted"  # Metric to optimize

# Inference settings
inference:
  batch_size: 64
  device: "auto"  # Options: auto, cuda, cpu

  # Reject predictions below this confidence
  rejection_threshold: 0.5

  # Return top-k predictions
  top_k: 3

# API settings
api:
  host: "0.0.0.0"
  port: 8000
  max_file_size_mb: 10
  allowed_extensions:
    - ".png"
    - ".jpg"
    - ".jpeg"
    - ".webp"

  # Rate limiting
  rate_limit_requests: 100
  rate_limit_window_seconds: 60

# Logging settings
logging:
  level: "INFO"
  log_dir: "outputs/logs"
  tensorboard: true
  tensorboard_dir: "outputs/logs/tensorboard"

# Interpretability settings
interpretability:
  # GradCAM for visual explanations
  gradcam:
    enabled: true
    target_layer: "last_conv"  # Will be determined based on architecture

  # SHAP values (computationally expensive)
  shap:
    enabled: false
    num_samples: 100
